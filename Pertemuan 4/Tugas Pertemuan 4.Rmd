---
title: "Tugas Pertemuan 4"
author: "Muhammad Fauzan Nur Rasendriya (G1401231108)"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    self_contained: true
    code_folding: show
    theme: flatly
    highlight: tango
    toc: true
    toc_depth: 5
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: false
    thumbnails: false
    lightbox: true
    gallery: true
    fig_caption: true
    df_print: paged
  pdf_document:
    latex_engine: xelatex
    toc: false
    toc_depth: 3
  word_document:
    toc: false
    toc_depth: '3'
header-includes:
- \usepackage{amsmath}
- \usepackage{amssymb}
- \usepackage{booktabs}
---

```{r setup, message=FALSE}
install_load <- function (package1, ...){   
   packages <- c(package1, ...)
   for(package in packages){
       if(package %in% rownames(installed.packages())){
         do.call('library', list(package))
       }
       else{
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}

install_load("knitr","showtext","TSA")

opts_knit$set(root.dir = normalizePath("./"))

font_add_google("Lato", "lato")
showtext_auto()
```

```{r}
set.seed(1234)
n <- 300
wn <- rnorm(n)
```

# Proses MA(2)

## Bangkitkan model MA(2) dengan parameter θ₁ = 0.4 dan θ₂ = 0.6 sebanyak 300 data (manual dan menggunakan arima.sim()).

```{r}
# Manual
ma2 <- wn[1:2]
for(i in 3:n){
   ma2[i] <- wn[i] + 0.4*wn[i-1] + 0.6*wn[i-2]
}
ma2

# Dengan arima.sim
ma2_sim <- arima.sim(list(order=c(0,0,2), ma=c(0.4,0.6)), n=n)
ma2_sim
```

## Buat plot time series, plot ACF, plot PACF, dan plot EACF. Identifikasi apakah data tersebut stasioner.

```{r}
ts.plot(ma2, main="Proses MA(2)")
acf(ma2, lag.max=20, main="ACF MA(2)")
pacf(ma2, main="PACF MA(2)")
eacf(ma2)
```
- Berdasarkan plot time series, terlihat bahwa model MA(2) yang dibangkitkan stasioner dalam rataan

- Berdasarkan plot ACF, terlihat bahwa plot ACF *cuts off* di lag kedua

- Berdasarkan plot PACF, terlihat bahwa plot PACF cenderung *tails off* dan membentuk gelombang sinus

- Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

## Buat scatterplot antara Yₜ dengan Yₜ₋₁, Yₜ dengan Yₜ₋₂, serta Yₜ dengan Yₜ₋₃.

```{r}
# Scatterplot Yt vs lag
yt <- ma2[-1]
yt_1 <- ma2[-n]
plot(y=yt, x=yt_1, main="Yt vs Yt-1")

yt2 <- ma2[-c(1,2)]
yt_2 <- ma2[-c((n-1),n)]
plot(y=yt2, x=yt_2, main="Yt vs Yt-2")

yt3 <- ma2[-c(1,2,3)]
yt_3 <- ma2[-c((n-2),(n-1),n)]
plot(y=yt3, x=yt_3, main="Yt vs Yt-3")
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$ dan $Y_t$ dengan $Y_{t-2}$.

## Hitung autokorelasi baik dari data simulasi maupun secara teoritis.

```{r}
cor(yt, yt_1)
cor(yt2, yt_2)
cor(yt3, yt_3)
```

# Proses AR(2)

## Bangkitkan model AR(2) dengan parameter φ₁ = 0.5 dan φ₂ = 0.2 sebanyak 300 data (manual dan menggunakan arima.sim()).

```{r}
# Manual
ar2 <- c(0,0)
for(i in 3:n){
   ar2[i] <- 0.5*ar2[i-1] + 0.2*ar2[i-2] + wn[i]
}
ar2

# Dengan arima.sim
ar2_sim <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=n)
ar2_sim
```

## Buat plot time series, plot ACF, plot PACF, dan plot EACF. Identifikasi apakah data tersebut stasioner.

```{r}
ts.plot(ar2, main="Proses AR(2)")
acf(ar2, lag.max=20, main="ACF AR(2)")
pacf(ar2, main="PACF AR(2)")
eacf(ar2)
```

- Berdasarkan plot time series, terlihat bahwa model AR(2) yang dibangkitkan stasioner dalam rataan

- Berdasarkan plot ACF, terlihat bahwa plot ACF cenderung *tails off* dan cenderung membentuk pola grafik sinus

- Berdasarkan plot PACF, terlihat bahwa plot PACF *cuts off* pada lag kedua

- Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(0)

## Buat scatterplot antara Yₜ dengan Yₜ₋₁, Yₜ dengan Yₜ₋₂, serta Yₜ dengan Yₜ₋₃.

```{r}
# Scatterplot
yt <- ar2[-1]
yt_1 <- ar2[-n]
plot(y=yt, x=yt_1, main="Yt vs Yt-1")

yt2 <- ar2[-c(1,2)]
yt_2 <- ar2[-c((n-1),n)]
plot(y=yt2, x=yt_2, main="Yt vs Yt-2")

yt3 <- ar2[-c(1,2,3)]
yt_3 <- ar2[-c((n-2),(n-1),n)]
plot(y=yt3, x=yt_3, main="Yt vs Yt-3")
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$, $Y_t$ dengan $Y_{t-2}$, dan $Y_t$ dengan $Y_{t-3}$.

## Hitung autokorelasi baik dari data simulasi maupun secara teoritis.

```{r}
cor(yt, yt_1)
cor(yt2, yt_2)
cor(yt3, yt_3)
```

# Proses ARMA(2,2)

## Bangkitkan model ARMA(2,2) dengan parameter θ₁ = 0.4, θ₂ = 0.6, φ₁ = 0.5, dan φ₂ = 0.2 sebanyak 300 data (manual dan menggunakan arima.sim()).

```{r}
# Manual
arma22 <- c(0,0)
for(i in 3:n){
   arma22[i] <- 0.5*arma22[i-1] + 0.2*arma22[i-2] +
                wn[i] + 0.4*wn[i-1] + 0.6*wn[i-2]
}
arma22

# Dengan arima.sim
arma22_sim <- arima.sim(list(order=c(2,0,2), ar=c(0.5,0.2), ma=c(0.4,0.6)), n=n)
arma22_sim
```

## Buat plot time series, plot ACF, plot PACF, dan plot EACF. Identifikasi apakah data tersebut stasioner.

```{r}
ts.plot(arma22, main="Proses ARMA(2,2)")
acf(arma22, lag.max=20, main="ACF ARMA(2,2)")
pacf(arma22, main="PACF ARMA(2,2)")
eacf(arma22)
```

- Berdasarkan plot time series, terlihat bahwa model ARMA(2,2) yang dibangkitkan stasioner dalam rataan

- Berdasarkan plot ACF, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*

- Berdasarkan plot PACF, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot PACF yang *tails off*

- Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(2)

## Buat scatterplot antara Yₜ dengan Yₜ₋₁, Yₜ dengan Yₜ₋₂, serta Yₜ dengan Yₜ₋₃.

```{r}
# Scatterplot
yt   <- arma22[-1]; yt_1 <- arma22[-n]
plot(y=yt, x=yt_1, main="Yt vs Yt-1")

yt2  <- arma22[-c(1,2)]; yt_2 <- arma22[-c((n-1),n)]
plot(y=yt2, x=yt_2, main="Yt vs Yt-2")

yt3  <- arma22[-c(1,2,3)]; yt_3 <- arma22[-c((n-2),(n-1),n)]
plot(y=yt3, x=yt_3, main="Yt vs Yt-3")
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$, $Y_t$ dengan $Y_{t-2}$, dan $Y_t$ dengan $Y_{t-3}$.

## Hitung autokorelasi baik dari data simulasi maupun secara teoritis.

```{r}
cor(yt, yt_1)
cor(yt2, yt_2)
cor(yt3, yt_3)
```